from probability.distribution import Distribution

distributions = {
    (2, 2) : Distribution([0, 2, 2, 2, 2, 2, 1]),
    (2, 3) : Distribution([0, 2, 3, 5, 6, 7, 10, 12, 12, 16, 23, 25, 28, 39, 44, 40, 29, 21, 18, 12, 6, 1]),
    (2, 4) : Distribution([0, 2, 3, 6, 10, 14, 19, 28, 42, 61, 85, 119, 161, 215, 293, 396, 506, 632, 788, 985, 1194, 1414, 1664, 1884, 1999, 1958, 1770, 1463, 1076, 667, 361, 190, 88, 39, 19, 7, 1]),
    (2, 5) : Distribution([0, 2, 3, 6, 11, 19, 30, 44, 68, 112, 176, 271, 411, 602, 851, 1232, 1783, 2530, 3567, 4996, 6838, 9279, 12463, 16597, 21848, 28227, 35682, 44464, 54597, 65966, 78433, 91725, 104896, 116966, 126335, 131998, 133107, 128720, 119332, 106335, 91545, 75742, 60119, 45840, 33422, 23223, 15140, 9094, 5073, 2605, 1224, 528, 225, 75, 20, 2]),
    (2, 6) : Distribution([0, 2, 3, 6, 11, 20, 36, 60, 95, 155, 258, 426, 688, 1106, 1723, 2615, 3901, 5885, 8851, 13205, 19508, 28593, 41179, 58899, 83582, 118109, 165136, 228596, 312542, 423797, 568233, 755727, 994641, 1296097, 1667002, 2119476, 2660415, 3300586, 4038877, 4877286, 5804505, 6810858, 7864146, 8929585, 9958080, 10902749, 11716813, 12356080, 12791679, 13002649, 12981651, 12723430, 12245198, 11572814, 10738102, 9772472, 8720063, 7623133, 6526376, 5459196, 4457799, 3546306, 2749552, 2068975, 1510134, 1064591, 720002, 464913, 284204, 165094, 89649, 45758, 21471, 9583, 3829, 1427, 430, 129, 33, 12, 2]),
    (2, 7) : Distribution([0, 2, 3, 6, 11, 20, 37, 67, 117, 198, 329, 557, 942, 1575, 2597, 4241, 6724, 10535, 16396, 25515, 39362, 60532, 92089, 138969, 207274, 307725, 453000, 664240, 964874, 1392975, 1992353, 2832063, 3988528, 5586275, 7756511, 10698721, 14621717, 19840724, 26676629, 35605683, 47083756, 61775128, 80280617, 103437923, 131954019, 166799476, 208715971, 258659945, 317168280, 384949885, 462104381, 548743615, 644208445, 747728714, 857838218, 972826409, 1090524780, 1208492639, 1324294771, 1435166611, 1538445477, 1631318167, 1711407623, 1776313778, 1824122769, 1853119548, 1862320864, 1851238359, 1820042135, 1769350453, 1700564453, 1615557458, 1516675570, 1406502343, 1288154452, 1164716069, 1039257451, 914718314, 793783415, 678934877, 571912137, 474232181, 386713150, 309907682, 243779436, 188010782, 142009132, 104838064, 75576381, 52999438, 36159280, 23830790, 15194456, 9260117, 5426429, 3003444, 1590744, 784126, 369889, 159376, 65645, 23761, 8357, 2499, 779, 198, 43, 8, 1]),
    (2, 8) : Distribution([0, 2, 3, 6, 11, 20, 37, 68, 125, 227, 394, 672, 1151, 1983, 3373, 5703, 9508, 15640, 25293, 40732, 65032, 103390, 162830, 255543, 397013, 613104, 938477, 1431068, 2162964, 3255845, 4860428, 7223861, 10649867, 15628073, 22747718, 32963838, 47397514, 67825949, 96317070, 136092168, 190813727, 266142022, 368381756, 507128327, 692814488, 941001379, 1268233753, 1698874519, 2258065650, 2982209905, 3907555448, 5085696837, 6565947616, 8417412079, 10702957193, 13509495739, 16910707683, 21007433464, 25877447013, 31626925469, 38325925624, 46071949391, 54912130427, 64918763515, 76101355145, 88490648648, 102047648278, 116751018040, 132505409053, 149228835807, 166764383803, 184966765671, 203618622735, 222514691756, 241382142517, 259966787337, 277960449271, 295081943100, 311010808823, 325463837570, 338143708463, 348798802857, 357188285632, 363122777100, 366454094751, 367084684402, 364980046796, 360148553876, 352681502793, 342697980498, 330404930925, 316016569511, 299835578333, 282143142510, 263298958005, 243614099782, 223467185032, 203158361349, 183041033440, 163369852182, 144442736471, 126444328389, 109590136516, 93982358698, 79746177980, 66904613969, 55493451442, 45469625811, 36796122643, 29384868876, 23146220598, 17969181807, 13736588669, 10333975043, 7638092829, 5545670809, 3944373649, 2749651769, 1870180124, 1243126852, 801762666, 503467189, 304395531, 178394161, 99679895, 53799988, 27346855, 13403417, 6103022, 2685607, 1076604, 420933, 146812, 51109, 15504, 4737, 1158, 294, 49, 8, 1]),
    (3, 3) : Distribution([0, 2, 4, 8, 16, 20, 39, 62, 116, 152, 286, 396, 748, 1024, 1893, 2512, 4485, 5638, 9529, 10878, 16993, 17110, 23952, 20224, 24047, 15578, 14560, 6274, 3910, 760, 221, 2]),
    (3, 4) : Distribution([0, 2, 4, 9, 20, 37, 63, 122, 232, 431, 781, 1392, 2494, 4442, 7854, 13899, 24215, 41802, 71167, 119888, 198363, 323206, 515778, 811000, 1248011, 1885279, 2782396, 4009722, 5621354, 7647872, 10065800, 12760413, 15570786, 18171606, 20299876, 21587248, 21841159, 20906905, 18899357, 16058335, 12772603, 9515217, 6583181, 4242753, 2503873, 1350268, 643245, 270303, 92311, 27116, 5390, 1115, 86, 18]),
    (3, 5) : Distribution([0, 2, 4, 9, 21, 42, 89, 164, 349, 644, 1349, 2473, 5109, 9110, 18489, 32321, 64962, 112445, 223153, 378761, 740095, 1231589, 2364342, 3847629, 7246578, 11506172, 21233764, 32854049, 59293970, 89146163, 157015152, 228894783, 392648931, 553489877, 922382155, 1253605100, 2023948293, 2642914623, 4120279612, 5148314561, 7724532034, 9199799154, 13246457713, 14989319785, 20670772402, 22175539691, 29256857608, 29720831702, 37494316617, 36040261784, 43456588792, 39489966889, 45473143333, 39013132880, 42843777396, 34634595224, 36201542605, 27498739245, 27279157652, 19394857005, 18188522435, 12035839867, 10609974233, 6480164672, 5324826466, 2963664642, 2241211464, 1114401509, 760520424, 327445752, 195462601, 69272233, 34371729, 9207635, 3495571, 621091, 163627, 17629, 3599, 280, 75, 12, 5, 2, 1]),
    (4, 4) : Distribution([0, 2, 4, 10, 24, 54, 107, 212, 446, 946, 1948, 3938, 7808, 15544, 30821, 60842, 119000, 231844, 447342, 859744, 1637383, 3098270, 5802411, 10783780, 19826318, 36142146, 65135623, 116238056, 204900019, 357071928, 613926161, 1042022040, 1742855397, 2873077198, 4660800459, 7439530828, 11668443776, 17976412262, 27171347953, 40271406380, 58469060820, 83099401368, 115516106664, 156935291234, 208207973510, 269527755972, 340163141928, 418170132006, 500252508256, 581813416256, 657076739307, 719872287190, 763865196269, 784195801886, 777302007562, 742946121222, 683025093505, 603043436904, 509897148964, 412039723036, 317373604363, 232306415924, 161303043901, 105730020222, 65450375310, 37942606582, 20696691144, 10460286822, 4961671731, 2144789574, 868923831, 311901840, 104859366, 29592634, 7766947, 1508596, 272198, 26638, 3406, 70, 17])
}

relay_distributions = {
    (2, 3) : Distribution([0, 0, 4, 12, 28, 60, 100, 176, 294, 514, 794, 1330, 2063, 3458, 5328, 8846, 13432, 21720, 31852, 49138, 67977, 97558, 124781, 162562, 187843, 215530, 218815, 213832, 185318, 148962, 106211, 67028, 36894, 16060, 5876, 1206, 225, 2]),
    (2, 4) : Distribution([0, 0, 0, 8, 40, 144, 448, 1224, 3100, 7376, 16928, 37700, 82588, 178006, 378442, 793352, 1645978, 3381508, 6891633, 13932450, 27962662, 55715826, 110273538, 216775936, 423324146, 821064882, 1581671626, 3025539020, 5746433871, 10834379896, 20274945341, 37648867738, 69359630882, 126738380506, 229657174636, 412584470018, 734746871436, 1296756832032, 2267873296738, 3929545662172, 6745149081869, 11468713496250, 19315041045924, 32218656743962, 53229605269446, 87101491698146, 141168837943604, 226617630238650, 360331551846395, 567489665135134, 885226986625962, 1367609935243828, 2092387917895619, 3169775388069980, 4753799178443788, 7056205056739236, 10363236744857861, 15054438546501618, 21622954770518655, 30694722946687328, 43044360202798675, 59602530187148686, 81450486853618000, 109794198017491800, 145912888403359836, 191074735864224670, 246418023742421999, 312796480586597982, 390597936496880747, 479546930116041596, 578518288723542514, 685383256936381788, 796933272796700935, 908897768834575196, 1016107153033987626, 1112780447820555692, 1192974450968987935, 1251106645026759006, 1282562114780937064, 1284231196639258506, 1254975289502791620, 1195856379452896386, 1110152587420386615, 1003070982520972660, 881232500277288146, 751973021238308100, 622563170462109757, 499495292545537918, 387890863892312229, 291182532981204920, 211009673109896533, 147404698531326256, 99112204297877983, 64043049820914366, 39700799518110179, 23569031307381122, 13373693676843929, 7238207332029682, 3728190687790135, 1822818186737474, 843710950970343, 368436058079280, 151285375469663, 58116651003482, 20797630936945, 6876053771878, 2088562664862, 574255892224, 141975807254, 30692056304, 5785515358, 898186086, 118152224, 11329922, 1003938, 43064, 3965, 34])
}

def get_distribution(w, h):
    if w > h:
        w, h = h, w

    if (w, h) not in distributions:
        raise ValueError(f"distribution for puzzle {w}x{h} is not available")

    return distributions[(w, h)]

def get_relay_distribution(start, end):
    if (start, end) not in relay_distributions:
        raise ValueError(f"distribution for {start}-{end} relay is not available")

    return relay_distributions[(start, end)]
